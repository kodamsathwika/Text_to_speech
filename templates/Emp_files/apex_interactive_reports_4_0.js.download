if(apex.worksheet===null||typeof(apex.worksheet)!="object"){apex.worksheet={}}apex.worksheet={ws:function(a){var b=this;this.ajax_busy=false;this.worksheet_id=false;this.report_id=false;this.current_col_id=false;this.last_col_id=false;this.current_control=false;this.active_dialog=false;this.supress_update=false;this.external_items=false;this.init=c;this.init(a);this.toggle_controls=function(){var d=($x("apexir_CONTROL_PANEL_COMPLETE").style.display!="none")?"Y":"N";$x_ToggleWithImage("apexir_CONTROLS_IMAGE",["apexir_CONTROL_PANEL_COMPLETE","apexir_CONTROL_PANEL_SUMMARY"]);b.supress_update=true;b.action("CONTROL_MIN",false,false,d)};this.item={};this.item.worksheet_holder=function(){return $x("apexir_WORKSHEET_REGION")};this.item.worksheet_detail=function(){return $x("apexir_DETAIL")};this.item.worksheet_report=function(){return $x("apexir_REPORT")};this.item.worksheet_div=function(){return $x("apexir_WORKSHEET")};this.item.control_panel_drop=function(){return $x("apexir_CONTROL_PANEL_DROP")};this.item.ws_control_panel=function(){return $x("apexir_CONTROL_PANEL")};this.item.worksheet_id=function(){return $x("apexir_NUM_ROWS")};this.item.search=function(){return $x("apexir_SEARCH")};this.item.search_column=function(){return $x("apexir_CURRENT_SEARCH_COLUMN")};this.dialog={};this.dialog.check=function(g){var f=html_GetTarget(g);var d=$x("apexir_rollover");var h=true;while(f.nodeName!="BODY"){f=f.parentNode;if(f==d){h=false}}if(h){b.dialog.reset()}};this.dialog.check2=function(g){var f=html_GetTarget(g);var d=$x("apexir_col_values_drop");if(d){var h=true;while(f.nodeName!="BODY"){f=f.parentNode;if(f==d){h=false}}if(h){$x_Remove("apexir_col_values_drop")}}};this.email={};this.email.send=function(){var d=$f_get_emptys("apexir_EMAIL_TO","error","");if(!!d){return}var e=["apexir_EMAIL_TO","apexir_EMAIL_CC","apexir_EMAIL_BCC","apexir_EMAIL_SUBJECT","apexir_EMAIL_BODY"];b.get.AddArrayItems(e,1);b.action("SEND_EMAIL")};this.email.show=function(d){$x_Show_Hide(["apexir_EMAIL","apexir_EMAIL_BUTTON"],"apexir_DOWNLOAD_BUTTON")};this.dialog.reset=function(){if(b.supress_update){}else{$d_ClearAndHide(["searchdrop",b.item.control_panel_drop(),"apexir_SEARCHDROP"]);$x_Hide(["searchdrop","apexir_rollover"]);$s("apexir_rollover_content","");if($x(b.last_col_id)){$x_Class($x(b.last_col_id).parentNode,"")}b.dialog.id=false;document.body.onclick="";apex.jQuery(document).unbind("keydown.menu_keys_colsearch")}};this.dialog.util_exp_type=function(){var d={};d.col=$x("apexir_COLUMN_NAME");d.col_type=d.col.options[d.col.selectedIndex].className;d.col_opt=$x("apexir_"+d.col_type+"_OPT");d.col_opt_val=$v(d.col_opt);if(d.col_type=="DATE"&&!(d.col_opt_val=="is in the last"||d.col_opt_val=="is not in the last"||d.col_opt_val=="is in the next"||d.col_opt_val=="is not in the next")){d.form_items=["apexir_BETWEEN_FROM","apexir_BETWEEN_TO"]}else{d.form_items=["apexir_EXPR","apexir_EXPR2"]}return d};this.dialog.validate=function(f){var e=[];var d=b.dialog.util_exp_type();switch(true){case (d.col_opt_val=="between"):e=[d.form_items[0],d.form_items[1]];break;case (d.col_opt_val=="is null"||d.col_opt_val=="is not null"):e=[];break;case (d.col_opt_val=="is in the last"||d.col_opt_val=="is not in the last"||d.col_opt_val=="is in the next"||d.col_opt_val=="is not in the next"):e=[d.form_items[0],"apexir_EXPR3"];break;default:e=[d.form_items[0]]}if($f_get_emptys(e,"error","")){return false}else{return d}};this.controls={};this.controls.cancel=function(){b.dialog.reset()};this.controls.save_toggle=function(e){var d=($v(e)=="NAMED")?"apexir_SAVE_NAMED":"apexir_SAVE_DEFAULT";$x_HideSiblings(d)};this.controls.drop=function(){return b.item.control_panel_drop()};this.controls.get=function(e,d){b.dialog.reset();b.l_Action="CONTROL";b.l_Type=e;b.current_control=e;b.current_dom=$x(d);if(d){b.current_col_id=d}b._Get("CONTROL",e,false,d)};this.controls.menu=function(e,d){b.dialog.reset();app_AppMenuMultiOpenBottom2(e,d,false)};this.controls.widget=function(d){this.get("SORT_WIDGET",d);b.current_col_dom=$x(d);document.body.onclick=b.dialog.check};this.controls.narrow=function(d){b.supress_update=true;b.temp_return_element=$x(d);this.get("NARROW",$v("apexir_COLUMN_NAME"))};this.controls.format_mask=function(d){b.supress_update=true;b.temp_return_element=$x(d);this.get("FORMAT_MASK_LOV")};this.controls.col_lov=function(d){this.get("COL_LOV",d)};this.controls.radio_lov=function(d){this.get("RADIO_LOV",d)};this.controls.filter2=function(){b.controls.set=true;this.get("SHOW_FILTER")};this.group_by={};this.group_by.view=function(){b.action("VIEW_GROUP_BY",false,false)};this.group_by.save=function(){b.supress_update=true;b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1);b.action("GROUP_BY_SAVE")};this.group_by.remove=function(){b.action("GROUP_BY_REMOVE")};this.group_by.control=function(g){var d,e,f;if(g){d=g.id;e=["SUM","AVG","MAX","MIN","MEDIAN","RATIO_TO_REPORT_SUM"];f=d.substr(d.length-2);if(apex.jQuery.inArray($v(g),e)!==-1){$x_Show_Hide("NUMBER_COLUMNS_"+f,"ALL_COLUMNS_"+f)}else{$x_Show_Hide("ALL_COLUMNS_"+f,"NUMBER_COLUMNS_"+f)}}};this.controls.row=function(d){this.get("SHOW_DETAIL",d)};this.controls.computation=function(d){d=(d)?d:b.dialog.id;this.get("SHOW_COMPUTATION",d);b.dialog.id=false};this.controls.info=function(d){this.get("INFO",b.current_col_id)};this.highlight={};this.highlight.clear=function(d){b.action("CLEAR_HIGHLIGHT",false,$nvl(d,$x("HIGHLIGHT_ID").value))};this.highlight.toggle=function(e,d){b.action("TOGGLE_HIGHLIGHT",false,d,(e.checked)?"Y":"N")};this.highlight.save=function(e){var d=b.dialog.validate();if(!d){return}b.supress_update=true;b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1);b.action("SAVE_HIGHLIGHT");d=null;return};this.navigate={};this.navigate.paginate=function(d){b.get.addParam("p_widget_num_return",d.split("max_rows=")[1].split("rows_fetched")[0]);b.action("PAGE",d)};this.column={};this.column.pOb=this;this.column.break_on=function(d){if(d){b.current_col_id=d}b.action("BREAK",false,b.current_col_id)};this.column.break_toggle=function(e,d){b.action("BREAK_TOGGLE",false,d,(e.checked)?"Y":"N")};this.column.hide=function(e){var d=(!!e)?e:b.current_col_id;b.action("HIDE",false,d)};this.column.filter=function(g){var d="ADD";if(g){b.current_col_id=g;d="UPDATE"}else{g=$v("apexir_COLUMN_NAME")}if($v("apexir_FILTER_TYPE")=="COLUMN"){var e=b.dialog.validate();if(!e){return}var f=["apexir_FILTER_TYPE",e.col,e.col_opt,e.form_items[0],e.form_items[1],"apexir_EXPR3"]}else{var f=["apexir_FILTER_TYPE","apexir_FILTER_EXPR","apexir_FILTER_NAME"]}b.get.AddArrayItems(f,1);b.supress_update=true;b.action("FILTER",d,g)};this.column.filter_delete=function(d){b.action("FILTER_DELETE",false,d)};this.column.filter_toggle=function(e,d){b.action("FILTER_TOGGLE",false,d,(e.checked)?"Y":"N")};this.column.filter_control=function(d){if($v("apexir_FILTER_TYPE")=="COLUMN"){$x_Show("apexir_COLUMN_FILTER");$x_Hide("apexir_ROW_FILTER")}else{$x_Show("apexir_ROW_FILTER");$x_Hide("apexir_COLUMN_FILTER")}};this.column.display=function(f){var e=[];var d=$x("apexir_shuttle2").getElementsByTagName("SELECT")[0];for(i=0,len=d.options.length;i<len;i++){e[e.length]=d.options[i].value}b.get.AddArray(e,1);b.action("SET_COLUMNS")};this.column.order=function(d){if(d=="ASC"||d=="DESC"){b.get.addParam("f01",b.last_col_id);b.get.addParam("f02",d);b.action("COLUMN_ORDER")}else{b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1);b.action("SORT")}};this.column.break_save=function(d){if(d=="ENABLE"||d=="DISABLE"){b.get.AddNameValue("apexir_COLUMN_01",b.last_col_id,1);b.get.AddNameValue("apexir_ENABLE_01",d,2)}else{b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1)}b.action("SAVE_BREAK")};this.flashback={};this.flashback.save=function(){b.supress_update=true;b.action("FLASHBACK_SET",false,false,$v("apexir_FLASHBACK_TIME"))};this.flashback.clear=function(){b.action("FLASHBACK_CLEAR",false,false,false)};this.flashback.toggle=function(){b.action("FLASHBACK_TOGGLE",false,false,false)};this.aggregate={};this.aggregate.control=function(){var d,e;d=$v("apexir_AGGREGATE_BY");e=["COUNT","COUNT_DISTINCT"];if(apex.jQuery.inArray(d,e)!==-1){$x_Show_Hide("ALL_COLUMNS","NUMBER_COLUMNS")}else{$x_Show_Hide("NUMBER_COLUMNS","ALL_COLUMNS")}};this.aggregate.save=function(){var f,d,g,e;f=$v("apexir_AGGREGATE_BY");d=$v("apexir_AGGREGATION");g=["COUNT","COUNT_DISTINCT"];e=(apex.jQuery.inArray(f,g)!==-1)?$v("apexir_COLUMN_NAME_ALL"):$v("apexir_COLUMN_NAME");b.action("SAVE_AGGREGATE",false,d,f,e)};this.aggregate.clear=function(){b.action("DELETE_AGGREGATE",false,$v("apexir_AGGREGATION"))};this.aggregate.toggle=function(){};this.computation={};this.computation.save=function(){var d=$f_get_emptys(["apexir_COLUMN_LABEL","apexir_COMPUTATION_EXPR"],"error","");if(!!d){return}b.supress_update=true;b.action("SAVE_COMPUTATION",false,$v("apexir_COMPUTATION_ID"),$v("apexir_COLUMN_LABEL"),$v("apexir_REPORT_LABEL"),$v("apexir_FORMAT_MASK"),$v("apexir_COMPUTATION_EXPR"))};this.computation.clear=function(){b.action("DELETE_COMPUTATION",false,$v("apexir_COMPUTATION_ID"))};this.computation.toggle=function(){};this.chart={};this.chart.control=function(e){var d=[];d[0]=$x("apexir_LABEL_AXIS_TITLE").parentNode;d[1]=$x("apexir_VALUE_AXIS_TITLE").parentNode;d[2]=d[0].previousSibling;d[3]=d[1].previousSibling;if($x("apexir_CHART_TYPE_2").checked){$x_Hide(d)}else{$x_Show(d)}};this.chart.save=function(){b.supress_update=true;var d=["apexir_CHART_TYPE","apexir_CHART_LABEL","apexir_CHART_VALUE","apexir_AGGREGATE_BY","apexir_LABEL_AXIS_TITLE","apexir_VALUE_AXIS_TITLE","apexir_SORT"];b.get.AddArrayItems(d,1);b.action("SAVE_CHART")};this.chart.clear=function(){b.action("DELETE_CHART")};this.chart.view=function(){b.action("VIEW_CHART",false,false)};this.email={};this.email.send=function(){var d=$f_get_emptys("apexir_EMAIL_TO","error","");if(!!d){return}var e=["apexir_EMAIL_TO","apexir_EMAIL_CC","apexir_EMAIL_BCC","apexir_EMAIL_SUBJECT","apexir_EMAIL_BODY"];b.get.AddArrayItems(e,1);b.action("SEND_EMAIL")};this.email.show=function(d){$x_Show_Hide(["apexir_EMAIL","apexir_EMAIL_BUTTON"],"apexir_DOWNLOAD_BUTTON")};this.calendar={};this.calendar.save=function(){b.action("SAVE_CALENDAR",false,false,$v("DATE_COLUMN"),$v("DISPLAY_COLUMN"))};this.calendar.view=function(){b.action("VIEW_CALENDAR",false,false)};this.data={};this.data.view=function(d){if(d){b.get.addParam("p_widget_view_mode",d)}b.action("VIEW_REPORT",false,false)};this.detail={};this.detail.last_row_opened=false;this.detail.show=function(d){if(b.ajax_busy){return}$x_Show(getElementsByClass("displayed"));$x_Show(getElementsByClass("other"));if($x("apexir_EXCLUDE_NULL_0").checked&&$x("apexir_DISPLAY_OPTION").checked){$x_Hide(getElementsByClass("null"));$x_Hide(getElementsByClass("other"))}else{if($x("apexir_EXCLUDE_NULL_0").checked){$x_Hide(getElementsByClass("null"))}else{if($x("apexir_DISPLAY_OPTION").checked){$x_Hide(getElementsByClass("other"))}}}b.l_Action="CHANGE_DETAIL_OPTION";b.supress_update=true;b.action("CHANGE_DETAIL_OPTION",false,false,$v("apexir_EXCLUDE_NULL_0"),$v("apexir_DISPLAY_OPTION"))};this.remove=function(e){var d;d=$nvl(e,"DELETE");b.action(d,false,false,false)};this.reset=function(){b.action("RESET",false,false,false)};this.save=function(f){var e=$x("create_category");var d=$f_get_emptys(["apexir_WORKSHEET_NAME"],"error","");if(e){d=$f_get_emptys([e],"error","")}if(!!d){return}l_cat=(e)?e.value:$v("apexir_WORKSHEET_CATEGORY");f=(!!f)?"RENAME":"SAVE";b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1);b.action(f,false,false)};this.get_saved_rpt_xml=function(){var h=$x("apexir_SAVED_REPORTS");var e=new htmldb_Get(null,$v("pFlowId"),"INTERNAL_APPLICATION_PROCESS=ir_reports_select_xml2",$v("pFlowStepId"));e.addParam("x01",$v("apexir_WORKSHEET_ID"));e.addParam("x02",b.report_id);gReturn=e.get("XML");if(gReturn&&h){var d=gReturn.getElementsByTagName("option").length;h.length=0;for(var f=0;f<d;f++){var g=gReturn.getElementsByTagName("option")[f];b.appendToSelect(h,g.getAttribute("value"),g.firstChild.nodeValue)}}e=null};this.appendToSelect=function(g,e,f){var d=document.createElement("option");d.value=e;if(document.all){g.options.add(d);d.innerText=f}else{d.appendChild(document.createTextNode(f));g.appendChild(d)}};this.save_default=function(f){var e,d;if($v("apexir_DEFAULT_TYPE")==="ALTERNATIVE"){d=$f_get_emptys(["apexir_WORKSHEET_NAME"],"error","")}if(!!!d){e=$nvl(f,"SAVE_DEFAULT");b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1);b.action(e,false,false,false)}};this.save_default_type_check=function(){if($v("apexir_DEFAULT_TYPE")==="PRIMARY"){$x_ItemRow("apexir_WORKSHEET_NAME","HIDE")}else{$x_ItemRow("apexir_WORKSHEET_NAME","SHOW")}};this.save_category_check=function(d){if(d.value=="new"){$dom_AddInput(d.parentNode,"text","create_category","")}else{$x_Remove("create_category")}};this.pull=function(e,d){if(!!e){b.report_id=e}b._Get("PULL",d)};this.download=function(d){};this.key={};this.key.$gAnchorList;this.key.navigate={};this.key.navigate.up=function(f){var e,d;e=apex.jQuery(f.target);d=b.key.$gAnchorList.index(e);b.key.$gAnchorList.eq(d-1).focus();f.preventDefault()};this.key.navigate.down=function(f){var e,d;e=apex.jQuery(f.target);d=b.key.$gAnchorList.index(e);b.key.$gAnchorList.eq(d+1).focus();f.preventDefault()};this.key.navigate.esc=function(e,d,f){b.dialog.reset();apex.jQuery(document).unbind("keydown."+f+"");d.focus();e.preventDefault()};this.key.navigate.enter=function(d){apex.jQuery(document).unbind("keydown."+d+"")};this.key.action=function(e,d,f){switch(e.which){case 40:b.key.navigate.down(e);break;case 38:b.key.navigate.up(e);break;case 27:b.key.navigate.esc(e,d,f);break;case 13:b.key.navigate.enter(f);break;default:null}};this.notify={};this.notify.save=function(){b.supress_update=true;var d=["apexir_NOTIFY_ID","apexir_EMAIL_ADDRESS","apexir_EMAIL_SUBJECT","apexir_NOTIFY_INTERVAL","apexir_START_DATE","apexir_START_HH","apexir_START_AM_PM","apexir_END_DAY","apexir_END_DAY_UNIT"];b.get.AddArrayItems2(d,1);b.action("SAVE_NOTIFY")};this.notify.clear=function(){b.action("DELETE_NOTIFY",false,$v("apexir_NOTIFY_ID"))};this.search=function(k,f){var j=b.item.search();var e=b.item.search_column();var g=$v("apexir_REPORT_ID");var h;if(k="SEARCH"){if(f){b.get.addParam("p_widget_num_return",f)}else{b.get.addParam("p_widget_num_return",$v("apexir_NUM_ROWS"))}if(!!b.external_items){var d=b.external_items.split(",");b.get.AddPageItems(d)}}if($v_IsEmpty(j)){b.get.AddArrayItems2($x_FormItems("apexir_TOOLBAR"),1);b.pull(g)}else{if(k="SEARCH"){b.get.AddArrayItems2($x_FormItems("apexir_TOOLBAR"),1);k="QUICK_FILTER"}else{h=[this.current_col_id,"=",$v(j)];k="FILTER";b.get.AddArray(h,1)}b.action(k,"ADD")}$s(j,"")};this.valid_action=function(d){if(d=="true"){b.pull()}else{$s("apexir_DIALOG_MESSAGE",d)}};this.action=function(n,d,k,m,l,j,h,g,e,f){b.l_Action=n;b._Get("ACTION",n,d,k,m,l,j,h,g,e,f)};this._Get=function(h,q,d,m,o,n,l,j,g,e,f){if(b.ajax_busy){return}else{b.ajax_busy=true}b._Loading();var k;k=["ACTION","PULL"];if(h&&apex.jQuery.inArray(h,k)!==-1){apex.jQuery("#"+$v("apexir_WORKSHEET_ID")).trigger("apexbeforerefresh",b.report_id)}b.get.addParam("p_widget_name","worksheet");(!!h)?b.get.addParam("p_widget_mod",h):null;(!!q)?b.get.addParam("p_widget_action",q):null;(!!d)?b.get.addParam("p_widget_action_mod",d):null;b.get.addParam("x01",$v("apexir_WORKSHEET_ID"));(!!b.report_id)?b.get.addParam("x02",b.report_id):"0";(!!m)?b.get.addParam("x03",m):null;(!!o)?b.get.addParam("x04",o):null;(!!n)?b.get.addParam("x05",n):null;(!!l)?b.get.addParam("x06",l):null;(!!j)?b.get.addParam("x07",j):null;(!!g)?b.get.addParam("x08",g):null;(!!e)?b.get.addParam("x09",e):null;(!!f)?b.get.addParam("x10",f):null;b.get.GetAsync(b._Return)};this._Loading=function(){$x_Hide("apexir_rollover");b._BusyGraphic(1);return};this._Finished_Loading=function(){b._BusyGraphic(4);if(ie){if(!!!b.lCSS){b.lCSS=document.createStyleSheet()}startTag='<style id="apexir_WORKSHEET_CSS" type="text/css">';endTag="</style>";var f=p.responseText.indexOf(startTag);var e=p.responseText.substring(f+startTag.length);var d=e.indexOf(endTag);e=e.substring(0,d);b.lCSS.cssText=e}document.onclick=null;b.init();if(gReport.websheet){gReport.websheet.init()}if(!!b.l_LastFunction){b.l_LastFunction();b.l_LastFunction=false}b.ajax_busy=false;return};this._BusyGraphic=function(d){if(d==1){$x_Show("apexir_LOADER")}else{$x_Hide("apexir_LOADER")}return};this._Return=function(){if(p.readyState==1){}else{if(p.readyState==2){}else{if(p.readyState==3){}else{if(p.readyState==4){$x_Hide("searchdrop").innerHTML="";if(b.l_Action=="CONTROL"){if(b.current_control=="COL_LOV"){var f=new $d_LOV_from_JSON();f.l_Type="SELECT";f.create(gReport.controls.lov_dom.parentNode,p.responseText);$s(f.l_Dom,gReport.controls.value);f.l_Dom.focus();f.l_Dom.id="killme";apex.jQuery(f.l_Dom).one("blur change",function(l){cellsave(l,this)})}else{if(b.current_control=="RADIO_LOV"){var f=new $d_LOV_from_JSON();f.l_Type="RADIO";f.create(gReport.controls.lov_dom,p.responseText,null,null,gReport.controls.value,true);lDialog.dialog({bgiframe:true,draggable:false,show:"drop",hide:"drop",modal:true,position:[gReport.websheet.currentForm.offsetLeft,gReport.websheet.currentForm.offsetTop+gReport.websheet.currentForm.offsetHeight],close:function(){cellsave(null,gReport.websheet.currentForm)}});apex.jQuery(":radio",gReport.controls.lov_dom).change(function(){$s(gReport.websheet.currentForm,this.id);apex.jQuery(gReport.controls.lov_dom).dialog("close")})}else{if(b.current_control=="SORT_WIDGET"){var e=$u_eval("("+p.responseText+")");b.dialog.id=e.dialog.id;var r=$x("apexir_rollover").getElementsByTagName("TABLE")[0];$x_Show_Hide([r,"apexir_sortup","apexir_sortdown","apexir_search","apexir_removefilter","apexir_hide","apexir_break","apexir_info","apexir_computation"],e.dialog.hide);$x_Hide(e.dialog.hide);if(e.dialog.uv){var u=e.dialog.row.length;for(var t=0;t<u;t++){if(e.dialog.row[t].R!=null){if(e.dialog.row[t].D!=null){var h=e.dialog.row[t].D}else{var h=e.dialog.row[t].R}var s=$dom_AddTag("apexir_rollover_content","a",h);s.apexir_RETURN_VALUE=e.dialog.row[t].R;s.href="javascript:void(false);";s.onclick=function(){var l=[b.current_col_id,"=",this.apexir_RETURN_VALUE,"",""];b.get.AddArray(l,1);b._Get("ACTION","COL_FILTER")}}}if(u>10){$x_Style("apexir_rollover_content","height","210px")}else{$x_Style("apexir_rollover_content","height","")}$x_Show("apexir_rollover_content");$s("apexir_search","")}else{$x_Hide("apexir_rollover_content")}var m=$x(b.current_col_dom);$x_Show("apexir_rollover");$x_Style("apexir_rollover","left",(findPosX(m.parentNode))+"px");$x_Style("apexir_rollover","top",(findPosY(m)+m.offsetHeight+5)+"px");$x_Class(m.parentNode,"current");b.last_col_id=m.id;document.body.onclick=b.dialog.check}else{if(b.current_control=="SHOW_FILTER"||b.current_control=="SHOW_HIGHLIGHT"){var j=b.item.control_panel_drop();apex.jQuery(j).html(p.responseText);$x_Show(j);ws_ColumnCheck($x("apexir_COLUMN_NAME"))}else{if(b.current_control=="SHOW_SAVE_DEFAULT"){var j=b.item.control_panel_drop();$s(j,p.responseText);$x_Show(j);b.save_default_type_check()}else{if(b.current_control=="NARROW"||b.current_control=="FORMAT_MASK_LOV"){var f=new $d_LOV_from_JSON();f.l_Type="a";f.create(y,p.responseText);f.l_Dom.id="apexir_col_values_drop";$x_Style(f.l_Dom,"height","200px");$x_Style(f.l_Dom,"display","block");if(!$x("apexir_col_values_drop_space")){lThis=$dom_AddTag($x(b.temp_return_element).parentNode,"BR");lThis.id="apexir_col_values_drop_space"}$x(b.temp_return_element).parentNode.appendChild(f.l_Dom);for(var t=0,u=f.l_NewEls.length;t<u;t++){s=f.l_NewEls[t];s.href="javascript:void(false)";if(b.current_control=="NARROW"){s.onclick=function(){var l=$x("apexir_COLUMN_NAME");var A=$x("apexir_"+l.options[l.selectedIndex].className+"_OPT");var B=$v(A);if(B=="in"||B=="not in"){B=$v(b.temp_return_element);$s(b.temp_return_element,(isEmpty(b.temp_return_element))?this.id:B+","+this.id)}else{$s(b.temp_return_element,this.id);$x_Remove("apexir_col_values_drop")}}}else{s.onclick=function(){$s(b.temp_return_element,this.id);$x_Remove("apexir_col_values_drop")}}}b.supress_update=false;b.l_Action=false;document.body.onclick=b.dialog.check2}else{if(b.current_control=="INFO"){var r=$x("apexir_rollover").getElementsByTagName("TABLE")[0];$x_Hide(r);$s("apexir_rollover_content",p.responseText);$x_Style("apexir_rollover_content","height","");var m=$x(b.current_col_dom);$x_Show("apexir_rollover");$x_Style("apexir_rollover","left",(findPosX(m.parentNode))+"px");$x_Style("apexir_rollover_content","top",(findPosY(m)+m.offsetHeight+5)+"px");$x_Class(m.parentNode,"current");b.last_col_id=m.id;document.body.onclick=b.dialog.check}else{if(b.current_control=="SEARCH_COLUMN"){var y=$x("apexir_SEARCHDROP");$s(y,"");var f=new $d_LOV_from_JSON();f.l_Type="a";f.create(y,p.responseText);f.l_Dom.id="apexir_columnsearch";var v=b.item.search_column();for(var t=0,u=f.l_NewEls.length;t<u;t++){f.l_NewEls[t].href="javascript:void(0)";f.l_NewEls[t].onclick=function(){if(this.id!=0){$s("apexir_SEARCH_COLUMN_DROP",this.innerHTML+"");$s(v,this.id)}else{$s("apexir_SEARCH_COLUMN_DROP","");$s(v,"")}$x_Hide(y);apex.jQuery("#apexir_SEARCH").focus();apex.jQuery(document).unbind("keydown.menu_keys_colsearch")}}$x_Show(y);document.body.onclick=b.dialog.check;b.key.$gAnchorList=apex.jQuery("#apexir_SEARCHDROP").children().children().filter("a");apex.jQuery(document).bind("keydown.menu_keys_colsearch",function(l){var A=[40,38,27,13];if(apex.jQuery("#apexir_SEARCHDROP:visible")[0]&&apex.jQuery.inArray(l.which,A)!==-1){b.key.action(l,apex.jQuery("#apexir_SEARCHDROPROOT"),"menu_keys_colsearch")}})}else{if(b.current_control=="SHOW_DETAIL"){$x_Hide(b.item.worksheet_report());$s("apexir_DATA_PANEL","");$s("apexir_CONTROL_PANEL_DROP","");$s(b.item.worksheet_detail(),p.responseText);$x_Show(b.item.worksheet_detail())}else{var j=b.item.control_panel_drop();apex.jQuery(j).html(p.responseText);if(b.current_control=="SHOW_CHART"){b.chart.control()}if(b.controls.set){$s("apexir_COLUMN_NAME",b.last_col_id);$s("apexir_EXPR",$v("apexir_SEARCH"));b.controls.set=false;$s("apexir_SEARCH","")}if(b.current_control=="SHOW_COLUMN"){window.g_Shuttlep_v01=null;if(!d){var d=[]}d[2]=$x("apexir_SHUTTLE_LEFT");d[1]=$x("apexir_SHUTTLE_RIGHT");window.g_Shuttlep_v01=new dhtml_ShuttleObject(d[2],d[1])}$x_Show(j)}}}}}}}}}var g=apex.jQuery(":input:visible",apex.jQuery("#apexir_CONTROL_PANEL_DROP"));if(g.length>0){g[0].focus()}}else{if(b.supress_update){if(b.l_Action=="SAVE_NOTIFY"||b.l_Action=="SAVE_COMPUTATION"||b.l_Action=="FLASHBACK_SET"||b.l_Action=="SAVE_HIGHLIGHT"||b.l_Action=="FILTER"||b.l_Action=="GROUP_BY_SAVE"||b.l_Action=="SAVE_CHART"){b.l_LastFunction=function(){b.valid_action(p.responseText)}}b.ajax_busy=false;b.supress_update=false;b.l_Action=false}else{b.ajax_busy=false;$x_Hide("apexir_rollover");s=$x("apexir_WORKSHEET");s.id="apexir_WORKSHEET_old";var o=$x("apexir_TOOLBAR_OPEN");o.id="apexir_TOOLBAR_OPEN_old";var w=$x("apexir_ACTIONSMENU");var q=$x("apexir_FORMAT_MENU");var k=$x("apexir_ROWS_PER_PAGE_MENU");w.id="apexir_ACTIONSMENU_old";q.id="apexir_FORMAT_MENU_old";k.id="apexir_ROWS_PER_PAGE_MENU_old";var n=$x("apexir_WEBSHEETMENU");if(n){var z=$x("apexir_ROWS");var x=$x("apexir_COLUMN");n.id="apexir_WEBSHEETMENU_old";z.id="apexir_ROWS_old";x.id="apexir_COLUMN_old"}lThis=$u_js_temp_drop();$s(lThis,p.responseText);s.parentNode.replaceChild($x("apexir_WORKSHEET"),s);if($x("apexir_TOOLBAR_OPEN")){apex.jQuery("#apexir_ACTIONSMENU_old,#apexir_FORMAT_MENU_old,#apexir_ROWS_PER_PAGE_MENU_old").remove();if(n){apex.jQuery("#apexir_WEBSHEETMENU_old,#apexir_ROWS_old,#apexir_COLUMN_old").remove()}o.parentNode.replaceChild($x("apexir_TOOLBAR_OPEN"),o)}else{w.id="apexir_ACTIONSMENU";q.id="apexir_FORMAT_MENU";k.id="apexir_ROWS_PER_PAGE_MENU";if(n){n.id="apexir_WEBSHEETMENU";z.id="apexir_ROWS";x.id="apexir_COLUMN"}}$d_ClearAndHide("apexir_DETAIL");$s("apexir_CURRENT_SEARCH_COLUMN","");$s("apexir_SEARCH_COLUMN_DROP","");$x_Show("apexir_REPORT");$u_js_temp_clear();apex.jQuery("#"+$v("apexir_WORKSHEET_ID")).trigger("apexafterrefresh",b.report_id)}}b._Finished_Loading()}else{return false}}}}};this.dialog2=this.controls.get;return;function c(d){this.l_Action=false;this.l_Type=false;b.ajax_busy=false;if(!!d){b.worksheet_id=d}b.report_id=($v("apexir_REPORT_ID"))?$v("apexir_REPORT_ID"):"0";if($x("apexir_REGION_ID")){apex.jQuery("#"+$v("apexir_REGION_ID")).bind("apexrefresh",function(){b.search()})}this.get=new htmldb_Get(null,$v("pFlowId"),"APXWGT",$v("pFlowStepId"))}}};